% !TEX root = main.tex
%----------------------------------------------------------------------
\chapter{Examples of transformations}\label{chap:transformations_examples}
%----------------------------------------------------------------------
%----------------------------------------------------------------------
\section{Standard normal CDF $\longrightarrow$ Normal CDF}
%----------------------------------------------------------------------

% example: standard normal
\begin{example}
Let $Z\sim N(0,1)$. Find the CDF of $X=\mu+\sigma Z$ in terms of the CDF of $Z$.
\end{example}
\begin{solution}
Let $F_X$ and $F_Z$ respectively denote the CDFs of $X$ and $Z$.
\[
F_X(x)
	= \prob(X\leq x)
	= \prob(\mu+\sigma Z\leq x)
	= \prob\left(Z\leq\frac{x-\mu}{\sigma}\right)
	= F_Z\left(\frac{x-\mu}{\sigma}\right).
\]
\end{solution}

%----------------------------------------------------------------------
\section{Standard normal CDF $\longrightarrow$ Chi-squared CDF}
%----------------------------------------------------------------------
\begin{example}[The chi-squared distribution]
Let $X\sim N(0,1)$. Find the CDF of $Y=X^2$.
\end{example}
\begin{solution}
The PDF of $X\sim N(0,1)$ is given by $f_X(x) = \displaystyle\frac{1}{\sqrt{2\pi}}e^{-z^2/2}$. Hence,
\[
\prob(Y\leq y) 
	= \prob(-\sqrt{y}\leq X\leq \sqrt{y})
	= \int_{-\sqrt{y}}^{\sqrt{y}} f_X(x)\,dx
	= \frac{2}{\sqrt{2\pi}}\int_0^{\sqrt{y}} e^{-x^2/2}\,dx.
\]
Using a change-of-variable $t=x^2$, we obtain
\[
\prob(Y\leq y) 
	= \int_0^{y} \left(\frac{1}{\sqrt{2\pi t}} e^{-t/2}\right)\,dt.
\]

This is the CDF of the \emph{chi-squared} distribution with one degree of freedom.
\end{solution}


%----------------------------------------------------------------------
\section{Standard uniform CDF $\longrightarrow$ Exponential CDF}
%----------------------------------------------------------------------
% example: uniform to exponential(1)
\begin{example}
Let $X\sim\text{Uniform}[0,1]$, and let $Y = -\theta\log X$ where $\theta>0$. Show that $Y\sim\text{Exponential}(\theta)$, where $\theta$ is a scale parameter.
\end{example}
\begin{solution}
Consider the transformation $g(x) = -\theta\log x$.
\bit
\it The CDF of $X$ is $F_X(x) = x$ for $x\in[0,1]$ (with $F_X(x)=0$ for $x<0$, and $F_X(x)=1$ for $x>1$).
\it The PDF of $X$ is $f_X(x) = 1$ for $x\in[0,1]$ (and zero otherwise).
\it $g(x)$ is a decreasing function (and thus has a unique inverse) over $\supp(f_X) = [0,1]$.
\it The support of $f_Y$ is $\supp(f_Y) = \{g(x) : x\in\supp(f_X)\} = [0,\infty)$.
\it The inverse transformation is $g^{-1}(y) = e^{-y/\theta}$ over $\supp(f_Y)$.
\eit
By Theorem~\ref{thm:transf_cdf},
\[
F_Y(y) 
	= 1 - F_X\big[g^{-1}(y)\big]
	= 1 - F_X(e^{-y/\theta})
	= 1 - e^{-y/\theta} \quad\text{for}\quad y>0.
\]
This is the CDF of the $\text{Exponential}(\theta)$ distribution, where $\theta$ is a scale parameter.
\end{solution}

%----------------------------------------------------------------------
\section{Exponential CDF $\longrightarrow$ Pareto CDF}
%----------------------------------------------------------------------

% example: exponential to pareto
\begin{example}
Let $X\sim\text{Exponential}(\alpha)$ where $\alpha$ is a rate parameter, and let $Y=\theta e^X$, where $\theta>0$ is a constant. Show that $Y$ has the so-called $\text{\emph{Pareto}}(\theta,\alpha)$ distribution, whose CDF is given by
\[
F_Y(y)= \begin{cases}
		1 - \left(\frac{\theta}{y}\right)^{\alpha}	& \text{for } y > \theta \\
		0											& \text{otherwise.}
	\end{cases}	
\]
\end{example}

\begin{solution}
Consider the transformation $g(x) = \theta e^x$.
\bit
\it The CDF of $X$ is $F_X(x) = 1 - e^{-\alpha x}$ for $x>0$ (and zero otherwise).
\it $\supp(f_X) = [0,\infty)$.
\it $\supp(f_Y) = \{\theta e^x: x\geq 0\} = [\theta,\infty)$.
\it $g(x)$ is an increasing function over $\supp(f_X)$; the inverse transformation is $g^{-1}(y) = \log(y/\theta)$.
\eit
By Theorem~\ref{thm:transf_cdf},
\[
F_Y(y)
	= F_X\left[\log \left(\frac{y}{\theta}\right)\right]
	= 1 - \exp\left[-\alpha\log \left(\frac{y}{\theta}\right)\right]
	= \begin{cases}
		1 - \displaystyle\left(\frac{\theta}{y}\right)^{\alpha}	& \text{for } y > \theta, \\[2ex]
		0					& \text{otherwise.}
	\end{cases}	
\]
as required.
\end{solution}

\begin{remark}
Compare the upper-tail probabilities of $X\sim\text{Exponential}(\alpha)$ and $Y\sim\text{Pareto}(\theta,\alpha)$:
%\begin{align*}
%\prob(X > x) & = e^{-\alpha x} \\
%\prob(Y > y) & = \theta^{\alpha} y^{\alpha}
%\end{align*}
\[
\prob(X > x) = e^{-\alpha x}
\qquad\text{and}\qquad
\prob(Y > y) = \theta^{\alpha} y^{-\alpha}.
\]
In both cases, the rate at which the tail probabilities converge to zero is controlled by the parameter $\alpha$. However, we can see that $\prob(X>x)\to 0$ relatively quickly as $x\to\infty$, the rate of convergence depending ``exponentially'' on $x$, while $\prob(Y>y)\to 0$ more slowly as $y\to\infty$, with the rate of convergence depending ``polynomially'' on $y$.
%\eit
%\bit
%\it $\prob(X>x) \to 0$ at an exponential rate as $x\to\infty$, while
%\it $\prob(Y>y) \to 0$ at only a polynomial rate as $y\to\infty$.
%\eit
Consequently, the Pareto distribution belongs to the class of \emph{heavy-tailed} distributions.
\end{remark}

%----------------------------------------------------------------------
\section{Normal PDF $\longrightarrow$ Standard normal PDF}
%----------------------------------------------------------------------

% example: standard normal
\begin{example}[The standard normal distribution]
Let $X\sim N(\mu,\sigma^2)$, and define $Z=(X-\mu)/\sigma$. Find the PDF of $Z$.
\end{example}
\begin{solution}
Let $g(X) = \displaystyle \frac{X-\mu}{\sigma}$. 
\bit
\it The PDF of $X$ is $f_X(x) = \displaystyle\frac{1}{\sigma\sqrt{2\pi}}\exp\left[-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2\right]$.
\it Because $\sigma>0$, we see that $g(x)$ is increasing over $\supp(f_X) = (-\infty,\infty)$.
\it $g(x)$ has inverse function $g^{-1}(z) = \mu + \sigma z$.
\it It is easy to check that $\displaystyle\frac{d}{dz}g^{-1}(z) = \sigma$.
\eit
Hence,
\begin{align*}
f_Z(z)
	& = f_X\big[g^{-1}(z)\big]\left|\frac{d}{dz}g^{-1}(z)\right| \\
	& = \sigma\cdot\frac{1}{\sigma\sqrt{2\pi}}\exp\left[-\frac{1}{2}\left(\frac{(\mu+\sigma z)-\mu}{\sigma}\right)^2\right]
	  = \frac{1}{\sqrt{2\pi}}e^{-z^2/2}
\end{align*}
\end{solution}

%----------------------------------------------------------------------
\section{Pareto PDF $\longrightarrow$ Standard uniform PDF}
%----------------------------------------------------------------------


% example: pareto
\begin{example}[The Pareto distribution]
The $\text{Pareto}(\theta,\alpha)$ distribution is a continuous distribution with PDF
\[
f_X(x) = \begin{cases}
	\displaystyle\frac{\alpha}{\theta}\left(\frac{\theta}{x}\right)^{\alpha+1}		& \text{for } x > \theta, \\[2ex]
	0																			& \text{otherwise.}
\end{cases}
\]
Let $X\sim\text{Pareto}(1,1)$. Find the PDF of $Y=1/X$.%\displaystyle\frac{1}{X}$.
\end{example}

\begin{solution}
$X\sim\text{Pareto}(1,1)$ has PDF 
\[
f_X(x) = \displaystyle\frac{1}{x^2} \quad\text{for $x>1$ (and zero otherwise)}.
\]

Let $g(x) = 1/x$. 
\bit
\it $g(x)$ is a monotonic decreasing function over $x>1$. 
\it The inverse function is $g^{-1}(y) = 1/y$.
\it $\supp(f_Y) = \{g(x): x\in\supp(f_X)\} = \{1/x :x\in(0,\infty)\} = (0,1)$.
\eit
%
%
%\it The support of $Y$ can be determined as follows:
%\begin{align*}
%\supp(f_X) = (0,\infty)
%	\Rightarrow 1 < X < \infty 
%	\Rightarrow 1 < \frac{1}{Y} < \infty 
%	\Rightarrow 0 < Y < 1
%	\Rightarrow \supp(f_Y) = (0,1). 
%\end{align*}
%\eit

Hence the PDF of $Y$ is given by
\begin{align*}
f_Y(y)
	  = f_X\big[g^{-1}(y)\big]\left|\frac{d}{dy}g^{-1}(y)\right| 
	& = f_X\left(\frac{1}{y}\right)\left|\frac{d}{dy}\left(\frac{1}{y}\right)\right| \\
	& = y^2 \left|-\frac{1}{y^2}\right| 
	= \begin{cases}
		1	& \text{for } 0<y<1 \\
		0	& \text{otherwise.}
	\end{cases}
\end{align*}
Thus $Y$ has the standard uniform distribution.
\end{solution}


%----------------------------------------------------------------------
\section{Normal PDF $\longrightarrow$ Lognormal PDF}
%----------------------------------------------------------------------


% example: lognormal
\begin{example}[The lognormal distribution]
If $X\sim(\mu,\sigma^2)$, then $Y=e^X$ is said to have \emph{lognormal} distribution. Find the PDF of $Y$.
\end{example}
\begin{solution}
Let $g(X) = e^X$. 
\bit
\it Recall that $f_X(x) = \displaystyle\frac{1}{\sigma\sqrt{2\pi}}\exp\left[-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2\right]$.
\it $g(x)$ is an increasing function over $\supp(f_X) = (-\infty,\infty)$.
\it $g(x)\in[0,\infty]$ for $x\in\R$ so $\supp(f_Y) = [0,\infty)$.
\it $g(x)$ has inverse function $g^{-1}(y) = \log y$, for which $\displaystyle \frac{d}{dy}g^{-1}(y) = \frac{1}{y}$.
\eit
Thus
\begin{align*}
f_Y(y)
	& = f_X\big[g^{-1}(y)\big]\left|\frac{d}{dy}g^{-1}(y)\right| \\
	& = f_X(\log y)\left|\frac{1}{y}\right| 
	=  \frac{1}{y\sigma\sqrt{2\pi}}\exp\left[-\frac{1}{2}\left(\frac{\log y-\mu}{\sigma}\right)^2\right]
\end{align*}
for $y>0$, and zero otherwise.
\end{solution}


%----------------------------------------------------------------------
\section{Lomax PDF $\longrightarrow$ Logistic CDF}
%----------------------------------------------------------------------


% example: pareto - logistic
\begin{example}[The logistic distribution]
The $\text{Lomax}(\theta,\alpha)$ distribution\footnote{The Lomax distribution is also known as the \emph{Pareto Type II distribution} and the \emph{shifted Pareto distribution}} is a continuous distribution with PDF
\[
f_X(x) = \frac{\alpha}{\theta}\left(1+\frac{x}{\theta}\right)^{-(\alpha+1)}	\quad\text{for $x > 0$, and zero otherwise.}
\]
Let $X\sim\text{Lomax}(1,1)$. Show that the CDF of $Z = \log X$ is given by
\[
F_Z(z) =  \frac{e^z}{1+e^z}.
\]
This is the CDF of the \emph{standard logistic distribution}.
\end{example}
\begin{solution}
Taking $\alpha=1$ and $\theta=1$, the PDF of $X$ is 
\[
f_X(x) = \frac{1}{(1 + x)^2}
\]
Consider the transformation $g(x) = \log x$.
\bit
\it $g(x)$ is an increasing function over $\supp(f_X)=(0,\infty)$.
\it $\supp(f_Z) = \{g(x):x\in\supp(f_X)\} = \{\log x: x\in(0,\infty)\} = (-\infty,\infty)$.
\it The inverse transformation is  $g^{-1}(z) = e^z$, and its first derivative is $\displaystyle\frac{d}{dz}g^{-1}(z) = e^z$.
\eit
The PDF of $Z = \log X$ is therefore given by
\[
f_Z(z) = f_X\big[g^{-1}(z)\big]\left|\frac{d}{dz}g^{-1}(z)\right| = \frac{e^z}{(1+e^z)^2},
\]
from which we the required CDF follows by integration.
%This is the PDF of the \emph{standard logistic distribution}. 
%Its CDF if given by $\displaystyle F_Z(z) = \frac{e^z}{(1+e^z)}$.
\end{solution}

%----------------------------------------------------------------------
\section{Exercises}
\input{ex08_transformations_examples}
%----------------------------------------------------------------------

%======================================================================
\endinput
%======================================================================
